INFO: command line ['./profiling/spd_means_issue.py', '-d', '180', '--omp_num_threads', '1', '-s', 'issue913_mkl-np-autograd-from-conda_dim=180+omp_num_th=1']
INFO: running code geomstats
INFO: user profiler cprofile
INFO: result file suffix issue913_mkl-np-autograd-from-conda_dim=180+omp_num_th=1

INFO: OMP_NUM_THREADS is 1
number of points 100
maximum number of iterations 1000
matrix dimension 180
DEBUG2: variance 16519.45977493684 distance 15339.649486367378 step 0.5
DEBUG2: variance 11432.777391114265 distance 9871.031348465227 step 0.5
DEBUG2: variance 5429.552717352607 distance 53.7687058544897 step 0.5
DEBUG2: variance 5419.661275650467 distance 22.365202686597183 step 0.5
DEBUG2: variance 5416.087916503221 distance 10.692269093441128 step 0.5
DEBUG2: variance 5414.601194946217 distance 5.709407857417321 step 0.5
DEBUG2: variance 5413.9005789236635 distance 3.3066947289931576 step 0.5
DEBUG2: variance 5413.533916952275 distance 2.0262402306839706 step 0.5
DEBUG2: variance 5413.326146212535 distance 1.2906798171410447 step 0.5
DEBUG2: variance 5413.201384236067 distance 0.8447407871662748 step 0.5
DEBUG2: variance 5413.1233722438155 distance 0.5638737160028695 step 0.5
DEBUG2: variance 5413.07311103459 distance 0.38200664466609 step 0.5
DEBUG2: variance 5413.04003269351 distance 0.26182197067544494 step 0.5
DEBUG2: variance 5413.017891573188 distance 0.18113547867640672 step 0.5
DEBUG2: variance 5413.002881568308 distance 0.12629386946484078 step 0.5
DEBUG2: variance 5412.992595597022 distance 0.08863793829047145 step 0.5
DEBUG2: variance 5412.985486579423 distance 0.06256485770700747 step 0.5
DEBUG2: variance 5412.980536111622 distance 0.04438153108587038 step 0.5
DEBUG2: variance 5412.9770668443025 distance 0.03162216236195442 step 0.5
DEBUG2: variance 5412.974621971121 distance 0.02262006451944561 step 0.5
DEBUG2: variance 5412.972890619376 distance 0.016238356389878604 step 0.5
DEBUG2: variance 5412.971659091832 distance 0.011694805930320124 step 0.5
DEBUG2: variance 5412.97077964406 distance 0.008447442048142798 step 0.5
DEBUG2: variance 5412.970149312188 distance 0.006118332328309778 step 0.5
DEBUG2: variance 5412.9696960988795 distance 0.0044424686224315895 step 0.5
DEBUG2: variance 5412.96936930245 distance 0.003233092765618085 step 0.5
DEBUG2: variance 5412.969132963483 distance 0.0023579915767033 step 0.5
DEBUG2: variance 5412.968961542636 distance 0.0017231878760521826 step 0.5
DEBUG2: variance 5412.968837071411 distance 0.0012616281174642524 step 0.5
DEBUG2: variance 5412.968746339529 distance 0.0009253087617276628 step 0.5
DEBUG2: variance 5412.968680135568 distance 0.0006797530550432018 step 0.5
DEBUG2: variance 5412.968631799915 distance 0.0005001291659853988 step 0.5
DEBUG2: variance 5412.968596292314 distance 0.0003685024101834334 step 0.5
DEBUG2: variance 5412.968570276592 distance 0.00027188793924589586 step 0.5
DEBUG2: variance 5412.968551208893 distance 0.0002008620452983121 step 0.5
DEBUG2: variance 5412.968537129584 distance 0.00014857096392558887 step 0.5
DEBUG2: variance 5412.968526752354 distance 0.00011001957790876328 step 0.5
DEBUG2: variance 5412.9685190155315 distance 8.156055287537145e-05 step 0.5
DEBUG2: variance 5412.968513333696 distance 6.052577364088052e-05 step 0.5
DEBUG2: variance 5412.968509132038 distance 4.496020570518803e-05 step 0.5
DEBUG2: variance 5412.9685062388235 distance 3.342897992030747e-05 step 0.5
DEBUG2: variance 5412.968503935936 distance 2.48774316048521e-05 step 0.5
DEBUG2: variance 5412.968502192894 distance 1.8529230525856547e-05 step 0.5
DEBUG2: variance 5412.96850083866 distance 1.3812166942611317e-05 step 0.5
DEBUG2: variance 5412.968499857617 distance 1.0303931964808367e-05 step 0.5
DEBUG2: variance 5412.968499166586 distance 7.692474284139152e-06 step 0.5
DEBUG2: variance 5412.968498675881 distance 5.746945336881588e-06 step 0.5
DEBUG2: variance 5412.9684982659155 distance 4.296382865138681e-06 step 0.5
DEBUG2: variance 5412.96849805466 distance 3.214041710974014e-06 step 0.5
DEBUG2: variance 5412.968497876706 distance 2.4058642258215515e-06 step 0.5
DEBUG2: variance 5412.968497631448 distance 1.8019837494541105e-06 step 0.5

DEBUG: converged after 51 iterations



         44170 function calls (43961 primitive calls) in 21.706 seconds

   Ordered by: cumulative time
   List reduced from 175 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.002    0.002   21.706   21.706 /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/learning/frechet_mean.py:397(fit)
        1    0.045    0.045   21.704   21.704 /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/learning/frechet_mean.py:96(_default_gradient_descent)
     3720   11.870    0.003   21.202    0.006 /user/mvesin/home/.conda/envs/geomstats-condamkl2numpy/lib/python3.7/site-packages/autograd/tracer.py:35(f_wrapped)
       52    0.124    0.002   18.356    0.353 /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/spd_matrices.py:582(log)
       52    0.001    0.000   18.085    0.348 /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/spd_matrices.py:560(_aux_log)
      206    0.003    0.000   13.397    0.065 /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/symmetric_matrices.py:196(apply_func_to_eigvals)
       52    0.000    0.000   12.985    0.250 /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/spd_matrices.py:338(logm)
      723    0.001    0.000   11.867    0.016 /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/matrices.py:71(mul)
      723    0.003    0.000   11.866    0.016 {built-in method _functools.reduce}
1969/1760    0.005    0.000    8.650    0.005 {built-in method numpy.core._multiarray_umath.implement_array_function}


         44170 function calls (43961 primitive calls) in 21.706 seconds

   Ordered by: internal time
   List reduced from 175 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     3720   11.870    0.003   21.202    0.006 /user/mvesin/home/.conda/envs/geomstats-condamkl2numpy/lib/python3.7/site-packages/autograd/tracer.py:35(f_wrapped)
      206    8.044    0.039    8.047    0.039 /user/mvesin/home/.conda/envs/geomstats-condamkl2numpy/lib/python3.7/site-packages/numpy/linalg/linalg.py:1337(eigh)
      829    0.670    0.001    0.670    0.001 {built-in method numpy.array}
      465    0.531    0.001    0.531    0.001 {built-in method numpy.core._multiarray_umath.c_einsum}
      103    0.312    0.003    0.392    0.004 /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/matrices.py:188(to_symmetric)
       52    0.124    0.002   18.356    0.353 /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/spd_matrices.py:582(log)
      104    0.057    0.001    0.059    0.001 /user/mvesin/home/.conda/envs/geomstats-condamkl2numpy/lib/python3.7/site-packages/numpy/linalg/linalg.py:477(inv)
        1    0.045    0.045   21.704   21.704 /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/learning/frechet_mean.py:96(_default_gradient_descent)
      980    0.006    0.000    0.006    0.000 {method 'astype' of 'numpy.ndarray' objects}
     3720    0.005    0.000    0.006    0.000 /user/mvesin/home/.conda/envs/geomstats-condamkl2numpy/lib/python3.7/site-packages/autograd/tracer.py:65(find_top_boxed_args)


         44170 function calls (43961 primitive calls) in 21.706 seconds

   Ordered by: call count
   List reduced from 175 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     7799    0.002    0.000    0.002    0.000 /user/mvesin/home/.conda/envs/geomstats-condamkl2numpy/lib/python3.7/site-packages/autograd/tracer.py:123(<lambda>)
     3720   11.870    0.003   21.202    0.006 /user/mvesin/home/.conda/envs/geomstats-condamkl2numpy/lib/python3.7/site-packages/autograd/tracer.py:35(f_wrapped)
     3720    0.005    0.000    0.006    0.000 /user/mvesin/home/.conda/envs/geomstats-condamkl2numpy/lib/python3.7/site-packages/autograd/tracer.py:65(find_top_boxed_args)
     2325    0.000    0.000    0.000    0.000 /user/mvesin/home/.conda/envs/geomstats-condamkl2numpy/lib/python3.7/site-packages/numpy/core/einsumfunc.py:989(_einsum_dispatcher)
1969/1760    0.005    0.000    8.650    0.005 {built-in method numpy.core._multiarray_umath.implement_array_function}
     1036    0.000    0.000    0.000    0.000 {built-in method builtins.issubclass}
      980    0.006    0.000    0.006    0.000 {method 'astype' of 'numpy.ndarray' objects}
      829    0.670    0.001    0.670    0.001 {built-in method numpy.array}
      723    0.003    0.000   11.866    0.016 {built-in method _functools.reduce}
      723    0.000    0.000    0.000    0.000 {built-in method builtins.getattr}


   Ordered by: internal time
   List reduced from 175 to 5 due to restriction <5>

Function                                                                                                              was called by...
                                                                                                                          ncalls  tottime  cumtime
/user/mvesin/home/.conda/envs/geomstats-condamkl2numpy/lib/python3.7/site-packages/autograd/tracer.py:35(f_wrapped)   <-     618    0.001    0.203  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/algebra_utils.py:72(from_vector_to_diagonal_matrix)
                                                                                                                             104    0.000    0.060  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/general_linear.py:55(inverse)
                                                                                                                             309    0.000    0.002  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/matrices.py:110(transpose)
                                                                                                                             104    0.000    0.250  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/matrices.py:311(trace_product)
                                                                                                                             206    0.001    0.001  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/symmetric_matrices.py:189(<lambda>)
                                                                                                                             464    0.006    8.056  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/symmetric_matrices.py:196(apply_func_to_eigvals)
                                                                                                                             367    0.001    0.095  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/learning/frechet_mean.py:96(_default_gradient_descent)
                                                                                                                             310    0.000    0.671  /user/mvesin/home/.conda/envs/geomstats-condamkl2numpy/lib/python3.7/site-packages/autograd/numpy/numpy_wrapper.py:55(array)
                                                                                                                            1238   11.861   11.864  {built-in method _functools.reduce}
/user/mvesin/home/.conda/envs/geomstats-condamkl2numpy/lib/python3.7/site-packages/numpy/linalg/linalg.py:1337(eigh)  <-     206    8.044    8.047  {built-in method numpy.core._multiarray_umath.implement_array_function}
{built-in method numpy.array}                                                                                         <-     310    0.670    0.670  /user/mvesin/home/.conda/envs/geomstats-condamkl2numpy/lib/python3.7/site-packages/autograd/numpy/numpy_wrapper.py:71(_array_from_scalar_or_array)
                                                                                                                             363    0.000    0.000  /user/mvesin/home/.conda/envs/geomstats-condamkl2numpy/lib/python3.7/site-packages/numpy/core/_asarray.py:14(asarray)
                                                                                                                             104    0.000    0.000  /user/mvesin/home/.conda/envs/geomstats-condamkl2numpy/lib/python3.7/site-packages/numpy/core/_asarray.py:86(asanyarray)
                                                                                                                              52    0.000    0.000  /user/mvesin/home/.conda/envs/geomstats-condamkl2numpy/lib/python3.7/site-packages/numpy/core/numeric.py:2197(isclose)
{built-in method numpy.core._multiarray_umath.c_einsum}                                                               <-     465    0.531    0.531  /user/mvesin/home/.conda/envs/geomstats-condamkl2numpy/lib/python3.7/site-packages/numpy/core/einsumfunc.py:997(einsum)
/home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/matrices.py:188(to_symmetric)                          <-      51    0.002    0.003  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/spd_matrices.py:496(_aux_exp)
                                                                                                                              52    0.310    0.389  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/spd_matrices.py:560(_aux_log)


   Ordered by: cumulative time
   List reduced from 175 to 5 due to restriction <5>

Function                                                                                                             called...
                                                                                                                         ncalls  tottime  cumtime
/home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/learning/frechet_mean.py:397(fit)                              ->       1    0.000    0.000  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/errors.py:45(check_parameter_accepted_values)
                                                                                                                              1    0.045   21.704  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/learning/frechet_mean.py:96(_default_gradient_descent)
                                                                                                                              1    0.000    0.000  {built-in method builtins.isinstance}
/home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/learning/frechet_mean.py:96(_default_gradient_descent)         ->       1    0.000    0.002  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/_backend/numpy/common.py:4(to_ndarray)
                                                                                                                            104    0.000    2.892  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/riemannian_metric.py:208(squared_norm)
                                                                                                                             51    0.000    0.314  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/spd_matrices.py:520(exp)
                                                                                                                             52    0.124   18.356  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/spd_matrices.py:582(log)
                                                                                                                              1    0.000    0.000  /user/mvesin/home/.conda/envs/geomstats-condamkl2numpy/lib/python3.7/logging/__init__.py:1984(info)
                                                                                                                            367    0.001    0.095  /user/mvesin/home/.conda/envs/geomstats-condamkl2numpy/lib/python3.7/site-packages/autograd/tracer.py:35(f_wrapped)
                                                                                                                              1    0.000    0.000  /user/mvesin/home/.conda/envs/geomstats-condamkl2numpy/lib/python3.7/site-packages/autograd/tracer.py:58(f_wrapped)
                                                                                                                             52    0.000    0.000  {built-in method builtins.print}
                                                                                                                             52    0.000    0.000  {method 'append' of 'list' objects}
                                                                                                                             53    0.001    0.001  {method 'format' of 'str' objects}
/user/mvesin/home/.conda/envs/geomstats-condamkl2numpy/lib/python3.7/site-packages/autograd/tracer.py:35(f_wrapped)  ->     310    0.000    0.670  /user/mvesin/home/.conda/envs/geomstats-condamkl2numpy/lib/python3.7/site-packages/autograd/numpy/numpy_wrapper.py:71(_array_from_scalar_or_array)
                                                                                                                           3720    0.005    0.006  /user/mvesin/home/.conda/envs/geomstats-condamkl2numpy/lib/python3.7/site-packages/autograd/tracer.py:65(find_top_boxed_args)
                                                                                                                              1    0.000    0.000  /user/mvesin/home/.conda/envs/geomstats-condamkl2numpy/lib/python3.7/site-packages/numpy/core/numeric.py:144(ones)
                                                                                                                            309    0.002    0.004  /user/mvesin/home/.conda/envs/geomstats-condamkl2numpy/lib/python3.7/site-packages/numpy/lib/twodim_base.py:152(eye)
                                                                                                                            155    0.000    0.002  <__array_function__ internals>:2(any)
                                                                                                                            206    0.000    8.047  <__array_function__ internals>:2(eigh)
                                                                                                                            465    0.000    0.533  <__array_function__ internals>:2(einsum)
                                                                                                                            104    0.000    0.059  <__array_function__ internals>:2(inv)
                                                                                                                             52    0.000    0.004  <__array_function__ internals>:2(isclose)
                                                                                                                             53    0.000    0.003  <__array_function__ internals>:2(norm)
                                                                                                                            105    0.000    0.002  <__array_function__ internals>:2(sum)
                                                                                                                            309    0.000    0.002  <__array_function__ internals>:2(transpose)
/home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/spd_matrices.py:582(log)                              ->      52    0.001   18.085  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/spd_matrices.py:560(_aux_log)
                                                                                                                             52    0.000    0.147  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/symmetric_matrices.py:170(powerm)
/home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/spd_matrices.py:560(_aux_log)                         ->     104    0.000    4.710  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/matrices.py:71(mul)
                                                                                                                             52    0.310    0.389  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/matrices.py:188(to_symmetric)
                                                                                                                             52    0.000   12.985  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/spd_matrices.py:338(logm)




RESULTS: geomstats cpu time 21.406534235000002
RESULTS: geomstats real time 21.705971717834473
