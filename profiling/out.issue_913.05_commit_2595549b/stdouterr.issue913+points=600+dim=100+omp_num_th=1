INFO: command line ['./profiling/spd_means_issue.py', '-d', '100', '-n', '600', '--omp_num_threads', '1', '-s', 'issue913+points=600+dim=100+omp_num_th=1']
INFO: running code geomstats
INFO: user profiler cprofile
INFO: result file suffix issue913+points=600+dim=100+omp_num_th=1

INFO: OMP_NUM_THREADS is 1
number of points 600
maximum number of iterations 1000
matrix dimension 100
DEBUG2: variance 4833.266520542631 distance 4334.634599565278 step 1.0
DEBUG2: variance 3000.1125234067376 distance 2214.73099399512 step 1.0
DEBUG2: variance 2771.391575148605 distance 1915.398569924233 step 1.0
DEBUG2: variance 2709.2925119774322 distance 1834.258223382194 step 1.0
DEBUG2: variance 2694.782847345464 distance 1816.5305043397057 step 1.0
DEBUG2: variance 2695.237598000636 distance 1818.7948134583144 step 1.0
DEBUG2: variance 2700.2672932350783 distance 1827.913641861997 step 1.0
DEBUG2: variance 2707.2203902935394 distance 1838.0194807010744 step 1.0
DEBUG2: variance 2712.9320783651424 distance 1847.9293683852998 step 0.5
DEBUG2: variance 2719.4257352501777 distance 1856.8017678398974 step 0.5
DEBUG2: variance 1683.0468395669961 distance 0.7870336071649149 step 0.5
DEBUG2: variance 1682.7647842447616 distance 0.06412535126265152 step 0.5
DEBUG2: variance 1682.74207771206 distance 0.005533781296638171 step 0.5
DEBUG2: variance 1682.7401391586936 distance 0.000501512980454886 step 0.5
DEBUG2: variance 1682.7399650751981 distance 4.730814053927038e-05 step 0.5
DEBUG2: variance 1682.7399487766554 distance 4.606515944579022e-06 step 0.5
DEBUG2: variance 1682.7399471990943 distance 4.5977119367171055e-07 step 0.5

DEBUG: converged after 17 iterations



         19288 function calls (19215 primitive calls) in 51.189 seconds

   Ordered by: cumulative time
   List reduced from 175 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.000    0.000   51.189   51.189 /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/learning/frechet_mean.py:385(fit)
        1    0.004    0.004   51.188   51.188 /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/learning/frechet_mean.py:96(_default_gradient_descent)
     1448    1.207    0.001   50.927    0.035 /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/autograd/tracer.py:35(f_wrapped)
 1030/957    0.004    0.000   49.484    0.052 {built-in method numpy.core._multiarray_umath.implement_array_function}
      371    0.000    0.000   41.654    0.112 <__array_function__ internals>:2(einsum)
      371    0.000    0.000   41.652    0.112 /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/numpy/core/einsumfunc.py:997(einsum)
      371   41.651    0.112   41.651    0.112 {built-in method numpy.core._multiarray_umath.c_einsum}
       18    0.007    0.000   29.829    1.657 /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/spd_matrices.py:622(log)
       18    0.009    0.001   29.784    1.655 /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/spd_matrices.py:595(_aux_log)
       36    0.000    0.000   21.220    0.589 /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/riemannian_metric.py:208(squared_norm)


         19288 function calls (19215 primitive calls) in 51.189 seconds

   Ordered by: internal time
   List reduced from 175 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
      371   41.651    0.112   41.651    0.112 {built-in method numpy.core._multiarray_umath.c_einsum}
      105    7.808    0.074    7.810    0.074 /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/numpy/linalg/linalg.py:1337(eigh)
     1448    1.207    0.001   50.927    0.035 /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/autograd/tracer.py:35(f_wrapped)
      391    0.231    0.001    0.231    0.001 {built-in method numpy.array}
       35    0.213    0.006    0.327    0.009 /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/matrices.py:189(to_symmetric)
       18    0.009    0.001   29.784    1.655 /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/spd_matrices.py:595(_aux_log)
       36    0.009    0.000   21.220    0.589 /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/spd_matrices.py:484(inner_product)
       36    0.007    0.000    0.007    0.000 {method 'trace' of 'numpy.ndarray' objects}
       18    0.007    0.000   29.829    1.657 /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/spd_matrices.py:622(log)
       36    0.007    0.000    0.008    0.000 /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/numpy/linalg/linalg.py:477(inv)


         19288 function calls (19215 primitive calls) in 51.189 seconds

   Ordered by: call count
   List reduced from 175 to 10 due to restriction <10>

   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
     3193    0.001    0.000    0.001    0.000 /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/autograd/tracer.py:123(<lambda>)
     1855    0.000    0.000    0.000    0.000 /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/numpy/core/einsumfunc.py:989(_einsum_dispatcher)
     1448    1.207    0.001   50.927    0.035 /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/autograd/tracer.py:35(f_wrapped)
     1448    0.002    0.000    0.003    0.000 /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/autograd/tracer.py:65(find_top_boxed_args)
 1030/957    0.004    0.000   49.484    0.052 {built-in method numpy.core._multiarray_umath.implement_array_function}
      461    0.000    0.000    0.000    0.000 {built-in method builtins.issubclass}
      439    0.002    0.000    0.002    0.000 {method 'astype' of 'numpy.ndarray' objects}
      391    0.231    0.001    0.231    0.001 {built-in method numpy.array}
      371    0.000    0.000   41.652    0.112 /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/numpy/core/einsumfunc.py:997(einsum)
      371    0.000    0.000   41.654    0.112 <__array_function__ internals>:2(einsum)


   Ordered by: internal time
   List reduced from 175 to 5 due to restriction <5>

Function                                                                                               was called by...
                                                                                                           ncalls  tottime  cumtime
{built-in method numpy.core._multiarray_umath.c_einsum}                                                <-     371   41.651   41.651  /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/numpy/core/einsumfunc.py:997(einsum)
/user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/numpy/linalg/linalg.py:1337(eigh)  <-     105    7.808    7.810  {built-in method numpy.core._multiarray_umath.implement_array_function}
/user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/autograd/tracer.py:35(f_wrapped)   <-     210    0.000    0.123  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/algebra_utils.py:72(from_vector_to_diagonal_matrix)
                                                                                                               36    0.000    0.008  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/general_linear.py:52(inverse)
                                                                                                              140    0.000    0.001  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/matrices.py:111(transpose)
                                                                                                              144    0.000   21.203  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/spd_matrices.py:461(_aux_inner_product)
                                                                                                               68    0.000    0.020  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/spd_matrices.py:527(_aux_exp)
                                                                                                               72    0.000   20.268  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/spd_matrices.py:595(_aux_log)
                                                                                                               70    0.000    0.000  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/symmetric_matrices.py:168(_power)
                                                                                                              438    1.206    9.017  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/symmetric_matrices.py:172(apply_func_to_eigvals)
                                                                                                              129    0.000    0.055  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/learning/frechet_mean.py:96(_default_gradient_descent)
                                                                                                              141    0.000    0.232  /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/autograd/numpy/numpy_wrapper.py:55(array)
{built-in method numpy.array}                                                                          <-     141    0.231    0.231  /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/autograd/numpy/numpy_wrapper.py:71(_array_from_scalar_or_array)
                                                                                                              160    0.000    0.000  /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/numpy/core/_asarray.py:14(asarray)
                                                                                                               72    0.000    0.000  /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/numpy/core/_asarray.py:86(asanyarray)
                                                                                                               18    0.000    0.000  /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/numpy/core/numeric.py:2197(isclose)
/home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/matrices.py:189(to_symmetric)           <-      17    0.000    0.001  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/spd_matrices.py:527(_aux_exp)
                                                                                                               18    0.212    0.326  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/spd_matrices.py:595(_aux_log)


   Ordered by: cumulative time
   List reduced from 175 to 5 due to restriction <5>

Function                                                                                                      called...
                                                                                                                  ncalls  tottime  cumtime
/home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/learning/frechet_mean.py:385(fit)                       ->       1    0.000    0.000  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/errors.py:45(check_parameter_accepted_values)
                                                                                                                       1    0.004   51.188  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/learning/frechet_mean.py:96(_default_gradient_descent)
                                                                                                                       1    0.000    0.000  {built-in method builtins.isinstance}
/home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/learning/frechet_mean.py:96(_default_gradient_descent)  ->       1    0.000    0.006  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/_backend/numpy/common.py:4(to_ndarray)
                                                                                                                      36    0.000   21.220  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/riemannian_metric.py:208(squared_norm)
                                                                                                                      17    0.000    0.074  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/spd_matrices.py:554(exp)
                                                                                                                      18    0.007   29.829  /home/mvesin/GIT/geomstats/mvesin_geomstats/geomstats/geometry/spd_matrices.py:622(log)
                                                                                                                       1    0.000    0.000  /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/logging/__init__.py:1984(info)
                                                                                                                     129    0.000    0.055  /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/autograd/tracer.py:35(f_wrapped)
                                                                                                                       1    0.000    0.000  /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/autograd/tracer.py:58(f_wrapped)
                                                                                                                      18    0.000    0.000  {built-in method builtins.print}
                                                                                                                      18    0.000    0.000  {method 'append' of 'list' objects}
                                                                                                                      19    0.000    0.000  {method 'format' of 'str' objects}
/user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/autograd/tracer.py:35(f_wrapped)          ->     141    0.000    0.231  /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/autograd/numpy/numpy_wrapper.py:71(_array_from_scalar_or_array)
                                                                                                                    1448    0.002    0.003  /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/autograd/tracer.py:65(find_top_boxed_args)
                                                                                                                       1    0.000    0.000  /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/numpy/core/numeric.py:144(ones)
                                                                                                                     105    0.001    0.001  /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/numpy/lib/twodim_base.py:152(eye)
                                                                                                                      88    0.000    0.001  <__array_function__ internals>:2(any)
                                                                                                                     105    0.000    7.810  <__array_function__ internals>:2(eigh)
                                                                                                                     371    0.000   41.654  <__array_function__ internals>:2(einsum)
                                                                                                                      36    0.000    0.008  <__array_function__ internals>:2(inv)
                                                                                                                      18    0.000    0.001  <__array_function__ internals>:2(isclose)
                                                                                                                      19    0.000    0.002  <__array_function__ internals>:2(norm)
                                                                                                                      37    0.000    0.000  <__array_function__ internals>:2(sum)
                                                                                                                      36    0.000    0.008  <__array_function__ internals>:2(trace)
                                                                                                                     140    0.000    0.001  <__array_function__ internals>:2(transpose)
{built-in method numpy.core._multiarray_umath.implement_array_function}                                       ->    1855    0.000    0.000  /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/numpy/core/einsumfunc.py:989(_einsum_dispatcher)
                                                                                                                     371    0.000   41.652  /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/numpy/core/einsumfunc.py:997(einsum)
                                                                                                                     140    0.000    0.000  /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/numpy/core/fromnumeric.py:601(transpose)
                                                                                                                      36    0.000    0.008  /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/numpy/core/fromnumeric.py:1637(trace)
                                                                                                                     106    0.000    0.000  /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/numpy/core/fromnumeric.py:1915(shape)
                                                                                                                      37    0.000    0.000  /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/numpy/core/fromnumeric.py:2105(sum)
                                                                                                                      88    0.000    0.001  /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/numpy/core/fromnumeric.py:2249(any)
                                                                                                                      36    0.000    0.000  /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/numpy/core/fromnumeric.py:2337(all)
                                                                                                                      18    0.000    0.001  /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/numpy/core/numeric.py:2197(isclose)
                                                                                                                      36    0.007    0.008  /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/numpy/linalg/linalg.py:477(inv)
                                                                                                                     105    7.808    7.810  /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/numpy/linalg/linalg.py:1337(eigh)
                                                                                                                      19    0.000    0.002  /user/mvesin/home/.conda/envs/geomstats/lib/python3.7/site-packages/numpy/linalg/linalg.py:2363(norm)
<__array_function__ internals>:2(einsum)                                                                      ->     371    0.001   41.653  {built-in method numpy.core._multiarray_umath.implement_array_function}




RESULTS: geomstats cpu time 51.112083107
RESULTS: geomstats real time 51.18864960735664
